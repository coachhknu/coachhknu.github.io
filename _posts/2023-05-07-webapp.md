```python
import pandas as pd
import numpy as np

ufos = pd.read_csv('ufos.csv')
ufos.head() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>city</th>
      <th>state</th>
      <th>country</th>
      <th>shape</th>
      <th>duration (seconds)</th>
      <th>duration (hours/min)</th>
      <th>comments</th>
      <th>date posted</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10/10/1949 20:30</td>
      <td>san marcos</td>
      <td>tx</td>
      <td>us</td>
      <td>cylinder</td>
      <td>2700.0</td>
      <td>45 minutes</td>
      <td>This event took place in early fall around 194...</td>
      <td>4/27/2004</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10/10/1949 21:00</td>
      <td>lackland afb</td>
      <td>tx</td>
      <td>NaN</td>
      <td>light</td>
      <td>7200.0</td>
      <td>1-2 hrs</td>
      <td>1949 Lackland AFB&amp;#44 TX.  Lights racing acros...</td>
      <td>12/16/2005</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10/10/1955 17:00</td>
      <td>chester (uk/england)</td>
      <td>NaN</td>
      <td>gb</td>
      <td>circle</td>
      <td>20.0</td>
      <td>20 seconds</td>
      <td>Green/Orange circular disc over Chester&amp;#44 En...</td>
      <td>1/21/2008</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10/10/1956 21:00</td>
      <td>edna</td>
      <td>tx</td>
      <td>us</td>
      <td>circle</td>
      <td>20.0</td>
      <td>1/2 hour</td>
      <td>My older brother and twin sister were leaving ...</td>
      <td>1/17/2004</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10/10/1960 20:00</td>
      <td>kaneohe</td>
      <td>hi</td>
      <td>us</td>
      <td>light</td>
      <td>900.0</td>
      <td>15 minutes</td>
      <td>AS a Marine 1st Lt. flying an FJ4B fighter/att...</td>
      <td>1/22/2004</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>




```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']}) 

ufos.Country.unique() 
```




    array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)



ê¸°ì¡´ì˜ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ latitude , longitude , duration(seconds), country(label)ë§Œìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°ì´í„° í”„ë ˆì„ ìƒì„±í•˜ê³  í•´ë‹¹ ë°ì´í„° ì…‹ì˜ ë ˆì´ë¸”ì´ ê°€ì§€ëŠ” ê°’ í™•ì¸í•œë‹¤


```python
ufos.dropna(inplace=True) 

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 25863 entries, 2 to 80330
    Data columns (total 4 columns):
     #   Column     Non-Null Count  Dtype  
    ---  ------     --------------  -----  
     0   Seconds    25863 non-null  float64
     1   Country    25863 non-null  object 
     2   Latitude   25863 non-null  float64
     3   Longitude  25863 non-null  float64
    dtypes: float64(3), object(1)
    memory usage: 1010.3+ KB


nanì´ í¬í•¨ëœ ë°ì´í„° ì œê±°ë¥¼ ì œê°€í•˜ê³  1ì´ˆ ë¶€í„° 60ì´ˆ ì‚¬ì´ì— ì¡´ì¬í•˜ëŠ” ë°ì´í„°ë§Œì„ ì‚¬ìš©ë¥¼ ì‚¬ìš©í•˜ëŠ” í”„ë ˆì„ ì •ë³´ë¥¼ ì¶œë ¥í•œë‹¤



```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])


ufos.head() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Seconds</th>
      <th>Country</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2700.0</td>
      <td>4</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7200.0</td>
      <td>5</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20.0</td>
      <td>3</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20.0</td>
      <td>4</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>900.0</td>
      <td>4</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>



LabelEncoderë¥¼ ì´ìš©í•˜ì—¬ êµ­ê°€ëª… ìˆ«ìë¡œ ì¹˜í™˜ í›„ ë°ì´í„° ìƒìœ„ 5ê°œ ë³´ì´ê¸°


```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features] # ë°ì´í„° ì…‹
y = ufos['Country'] # ë ˆì´ë¸”

X_train, X_test, y_train, y_test = train_test_split(X, y,test_size=0.2,random_state=0)
# í›ˆë ¨ ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ì…‹ ë¶„ë¦¬ (20% ì˜ í…ŒìŠ¤íŠ¸ ì…‹)
```


```python
from sklearn.metrics import accuracy_score, classification_report
from sklearn.linear_model import LogisticRegression

model = LogisticRegression()
model.fit(X_train, y_train)
predictions = model.predict(X_test)


print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))
```

                  precision    recall  f1-score   support
    
               0       0.00      0.00      0.00       105
               1       0.00      0.00      0.00       649
               2       0.00      0.00      0.00        24
               3       0.00      0.00      0.00       428
               4       0.83      1.00      0.91     12945
               5       1.00      0.01      0.02      1916
    
        accuracy                           0.81     16067
       macro avg       0.30      0.17      0.15     16067
    weighted avg       0.79      0.81      0.73     16067
    
    Predicted labels:  [4 4 4 ... 4 4 4]
    Accuracy:  0.8070579448559159


    c:\Users\LEE\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\linear_model\_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      n_iter_i = _check_optimize_result(
    c:\Users\LEE\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\metrics\_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
      _warn_prf(average, modifier, msg_start, len(result))
    c:\Users\LEE\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\metrics\_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
      _warn_prf(average, modifier, msg_start, len(result))
    c:\Users\LEE\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\metrics\_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
      _warn_prf(average, modifier, msg_start, len(result))


ëª¨ë¸ í›ˆë ¨ í›„ ëª¨ë¸ í‰ê°€ë¥¼ ì¶œë ¥


```python
import pickle


model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb')) 


model = pickle.load(open('ufo-model.pkl','rb')) 
print(model.predict([[50,44,-12]]))
```

    [4]


    c:\Users\LEE\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py:439: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
      warnings.warn(


ë§Œë“  ëª¨ë¸ì„ .pkl formatìœ¼ë¡œ ë§Œë“¤ì–´ ufo-model.pklë¡œ ì €ì¥ í›„ ì˜ˆì¸¡í•´ë³´ê¸°

ì´ì œ í”Œë¼ìŠ¤í¬ ì•±ì„ êµ¬ì¶•í•˜ì—¬ ëª¨ë¸ì„ í˜¸ì¶œí•˜ê³  ìœ ì‚¬í•œ ê²°ê³¼ë¥¼ ë°˜í™˜

ë¨¼ì € ufo-model.pkl íŒŒì¼ì´ ìˆëŠ” notebook.ipynb íŒŒì¼ ì˜†ì— web-appì´ë¼ëŠ” í´ë”ë¥¼ ë§Œë“ ë‹¤

ì´ í´ë”ì—ì„œ í´ë”, ë‚´ë¶€ì— í´ë” CSS ë° í…œí”Œë¦¿ì„ ì„¸ ê°œ ë” ë§Œë“­ë‹ˆë‹¤.ì´ì œ ë‹¤ìŒ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ê°€ ìˆì–´ì•¼í•œë‹¤


```python
web-app/
  static/
    css/
  templates/
Untitled0.ipynb
ufo-model.pkl
```

ì›¹ ì•± í´ë”ì— ì‘ì„±í•  ì²« ë²ˆì§¸ íŒŒì¼ì€ requirements.txt íŒŒì¼.
requriements.txt íŒŒì¼ì€ í•´ë‹¹ Flask ì•±ì„ êµ¬ì„±í•¨ì— ìˆì–´ì„œ í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ê¸° ìœ„í•œ íŒŒì¼ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ ì…ë ¥í•œë‹¤.

ì…ë ¥ í›„
CMD ì‹¤í–‰
cd web-app(í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™)
pip install -r requirements.txtë¥¼ ì…ë ¥í•˜ì—¬ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜



```python
scikit-learn 
pandas 
numpy
flask
```

ì´ì œ ê°ê°ì˜ ìœ„ì¹˜ì— app.py, index.html, styles.css íŒŒì¼ì„ ë§Œë“ ë‹¤

styles.css

ì´ íŒŒì¼ì€ HTML íŒŒì¼ì˜ ë””ìì¸ ìš”ì†Œë¥¼ ê¸°ì…í•˜ëŠ” íŒŒì¼ì´ë‹¤. ì•„ë˜ì˜ ë‚´ìš©ì„ ì¶”ê°€í•œë‹¤


```python
body {
	width: 100%;
	height: 100%;
	font-family: 'Helvetica';
	background: black;
	color: #fff;
	text-align: center;
	letter-spacing: 1.4px;
	font-size: 30px;
}

input {
	min-width: 150px;
}

.grid {
	width: 300px;
	border: 1px solid #2d2d2d;
	display: grid;
	justify-content: center;
	margin: 20px auto;
}

.box {
	color: #fff;
	background: #2d2d2d;
	padding: 12px;
	display: inline-block;
}
```

index.html

ì´ íŒŒì¼ì€ ì›¹ ì‹¤í–‰ì‹œ ë‚˜ì˜¤ëŠ” í˜ì´ì§€ì´ê³ , ëª¨ë¸ í›ˆë ¨ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ì´ë‹¤

í…œí”Œë¦¿ ì—”ì§„ì„ ì´ìš©í•˜ì—¬ stlyes.css íŒŒì¼ì„ í˜¸ì¶œí•œë‹¤.

ë˜í•œ /predictë¼ëŠ” url í˜•ì‹ì„ ì´ìš©í•œë‹¤.


```python
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  </head>

  <body>
    <div class="grid">

      <div class="box">

        <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>

        <form action="{{ url_for('predict')}}" method="post">
          <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />
          <input type="text" name="latitude" placeholder="Latitude" required="required" />
          <input type="text" name="longitude" placeholder="Longitude" required="required" />
          <button type="submit" class="btn">Predict country where the UFO is seen</button>
        </form>

        <p>{{ prediction_text }}</p>

      </div>

    </div>

  </body>
</html>
```

app.py

Flask ì˜ ë©”ì¸ í•¨ìˆ˜ë¡œ Flaskì˜ ê°€ì¥ ì¤‘ìš”í•œ ì—­í• ì„ í•˜ëŠ” íŒŒì¼
ì´ íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ index.htmlë¥¼ í˜¸ì¶œí•˜ê³  ê·¸ íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ë³´ë‚´ë©´ ê·¸ ë‚´ìš©ìœ¼ë¡œ ëª¨ë¸ì„ êµ¬í˜„í•´ì„œ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.


```python
import numpy as np
from flask import Flask, request, render_template
import pickle

app = Flask(__name__)

model = pickle.load(open("./ufo-model.pkl", "rb"))


@app.route("/")
def home():
    return render_template("index.html")


@app.route("/predict", methods=["POST"])
def predict():

    int_features = [int(x) for x in request.form.values()]
    final_features = [np.array(int_features)]
    prediction = model.predict(final_features)

    output = prediction[0]

    countries = ["Australia", "Canada", "Germany", "UK", "US"]

    return render_template(
        "index.html", prediction_text="Likely country: {}".format(countries[output])
    )


if __name__ == "__main__":
    app.run(debug=True)
```

ëª¨ë“  ê³¼ì •ì„ ì™„ë£Œí›„ app.pyë¥¼ ì‹¤í–‰í•˜ê³  ë¡œì»¬ì—ì„œ ì›¹ì„œë²„ê°€ ì œëŒ€ë¡œ ì‘ë™ë˜ëŠ”ì§€ë¥¼ í™•ì¸í•´ë³´ì•˜ë‹¤.

ì´ˆê¸° í˜ì´ì§€ê°€ ì œëŒ€ë¡œ ì‘ë™í–ˆê³  ê°ê° ì‹œê°,ìœ„ë„,ê²½ë„ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ê°€ ì‹¤í–‰ë˜ì—ˆë‹¤.

Seconds : 20, Latitude : 53, Longitude : -2 ë¥¼ ì…ë ¥í•˜ì USë¼ëŠ” ê°’ì´ ë°˜í™˜ë˜ì—ˆë‹¤.
